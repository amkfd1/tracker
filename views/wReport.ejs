<style>
	.smallIcons{
		max-width: 15px;
		max-height: 15px;
	}

	@media print{
    body *:not(#my-section):not(#my-section *){
        visibility:hidden;
    }
	
    #my-section{
        position: absolute;
        top: 0;
        left: 0;
		/* page: 1; */
		margin-left: -20%;
		visibility: visible;
		align-items: center;
		justify-content: center;
		min-width: 120%;
		min-height: 500%;
		zoom: 1.2;
    }

	#my-notSection{
        
		visibility: hidden;
		
    }
}
</style>

<%- include('includes/head') %>

<body class="sidebar-dark">

	<div class="main-wrapper">
	<%- include('includes/_sidebar') %>

		<div class="page-wrapper">
			<%- include('includes/_navbar.ejs') %>
			<div class="page-content d-flex align-items-center justify-content-center" style="margin-top: 0;">

				
				<div class="card mt-5" style=" width: 100%; height: 100vh; ">
					<div class="card-body card-body-alt px-5" >
						<div class="row">
							<div class="col-md-11" id= "my-section">
								<section id= "">
									<div class="card-" style="min-height: 100%;" ><div class="table-responsive ">
										<table class="table table-bordered table-dark my-4">
											
											<tbody>
												
												<tr class="">
													
													<td class="card-title text-center">
														Weekly Operation Report
													</td>
													<td class="text-muted text-center">
														<%= ReportDateRange %>
													</td>
													
												</tr>

												
											
											</tbody>
										</table>
									</div>


										<!-- Carrier weekly Activity minutes/Balance/Threshold -->
										<div class="card-title mt-3  px-2" >
											Carrier Activity Summary
										</div>
										<table class="table table-dark mt-3 mx-2" >
											<thead>
												<tr>
													<th>
														#
													</th>
													<th>
														Carrier
													</th>
													<th>
														Credit Balance
													</th>
													<th>
														Credit Limit
													</th>
													<th>
														Weekly Minutes
													</th>
													<th>
														Alert Active
													</th>
												</tr>
											</thead>
											<tbody>
												<% let counter = 0%>
												<%for (i in performance) {%>
													<%counter = counter + 1%>
													<tr>
														<td>
															<%= counter%>
														</td>
														<td>
															<%= performance[i].carrier.Customer_Name%>

														</td>
														<td>
															$ <%= performance[i].carrier.CB%>

														</td>
														<td>
															
															$ <%= performance[i].carrier.CL%>

														</td>
														<td>
															<%= performance[i].totalMinutesRoutesTerminated%>

														</td>
														<td class="text-success">
															True
														</td>
													</tr>
												<% } %>
												
											</tbody>
										</table>
	
										<!-- Customer Tickets -->
									<div class="card-title mt-3 px-2" >
										Tickets Summary
									</div>
									
										<table class="table table-dark mx-2" >
											<thead>
												<tr>
													<th>
														#
													</th>
													<th>
														Carrier
													</th>
													<th>
														Logged Issue
													</th>
													<th>
														Dates
													</th>
													<th>
														Status
													</th>
												</tr>
											</thead>
											<tbody>
												<%for (i in tickets) {%>
													<tr>
														<td>
															<%= i%>
														</td>
														<td>
															<%= tickets[i].type%>
														</td>
														<td>
															<%= tickets[i].subject%>
														</td>
														<td>
															<%= (tickets[i].date).toISOString().split('T')[0];%>
														</td>
														<td class="text-green">
															<%= tickets[i].status%>
														</td>
													</tr>
												<% } %>
												
													
											</tbody>
										</table>
										<!-- End tickets -->
	
										<div class="card-title mt-2 px-2" >
											Rate Notification
										</div>
										<div class="table-responsive ">
											<table class="table table-bordered">
												<thead>
													<tr>
														<th>
															#
														</th>
														<th>
															Supplier 
														</th>
														<th>
															Product
														</th>
														
													</tr>
												</thead>
												<tbody>
													<tr class="table-warning text-dark">
														<td>
															1
														</td>
														<td>
															Cedric Kelly
														</td>
														<td>
															Photoshop
														</td>
														
													</tr>
													<tr class="table-warning text-dark">
														<td>
															2
														</td>
														<td>
															Haley Kennedy
														</td>
														<td>
															Flash
														</td>
														
													</tr>
												
												</tbody>
											</table>
										</div>
		
										<!-- Other Updates -->
										<div class="card-title mt-3 px-2">
											Other Updates
										</div>
										<div class="table-responsive pt-3">
											<table class="table table-bordered">
												<thead>
													<tr>
														<th>
															By:
														</th>
														<th>
															Other Update
														</th>
														<th>
															<a href="#" data-toggle="modal" data-target="#plus" data-whatever="@fat" >
																<i data-feather="plus"></i>
															</a>
														</th>
														
													</tr>
												</thead>
												<tbody>
													<style>
														#containerSide {
															position: relative;
														}
														.copyright {
															position: absolute;
															bottom: 0;
														}
													</style>
													
													<%for (i in updates) {%>
														<tr class="table-primary text-dark">
														
															<td>
																<%= updates[i].postedBy.name%>
															</td>
															
															<td>
																<%- updates[i].update%>
															</td>
															<td>
																<a href="#" data-toggle="modal" data-target="#Edit<%= updates[i]._id%>" data-whatever="@fat" >
																	<i class="appIcons text-muted my-notSection" data-feather="edit-2" ></i>
																</a>
															</td>
														</tr>
														<!-- Update Modal -->
														<div class="modal fade" id="Edit<%= updates[i]._id%>" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
															<div class="modal-dialog" role="document">
															  <div class="modal-content">
																<div class="modal-header">
																  <h5 class="modal-title" id="exampleModalLabel">Edit Updates</h5>
																  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
																	<span aria-hidden="true">&times;</span>
																  </button>
																</div>
																<div class="modal-body">
																  <form action="/w/updates/<%= updates[i]._id%>" method="post">
																	<!-- <script>
																		new FroalaEditor('#textarea');
																	  </script> -->
																	<div class="row">
																		<div class="col-md-12 grid-margin stretch-card">
																				<div class="card-body">
																					<textarea class="form-control" id="textareab" rows="10" name="update"><%- updates[i].update%></textarea>
																				</div>
																		</div>
																	</div>
														  
																<div class=" page-content d-flex justify-content-center align-items-center">
																<div class="modal-footer">
																  <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
																  <button type="submit" class="btn btn-primary"><i data-feather="plus"></i> 
																  Update
																</button>
																</div>
															  </div>
															  <input type="hidden" name="rid" value="<%= weeklyReports._id%>" id="">
																  </form>
																</div>
															  
															  </div>
															</div>
														   </div>
													<% } %>
												</tbody>
											</table>
										</div>
	
	
									</div>
								</section>
								
								<!-- Rates -->
								

								<!--end of report page  -->
							</div>
							
	
							<div class="col-md-1">
								<div class=" bg-transparent" >
									

									<div  class="float-right mr-4 " >
										<div style="position: fixed;" class="text-muted">
											
												<button type="button" class="btn btn-secondary btn-icon hvr-bounce-in animate__animated animate__backInDown ">
													<i class="link-icon" data-feather="printer"  onclick="window.print()"> </i>
												</button>
										<br>
											
											<button type="button" class="btn btn-info btn-icon my-3 hvr-bounce-in animate__animated animate__backInDown">
												<i data-feather="refresh-ccw"></i>
											</button>
											<br>
											<form action="/wr/reports/report/submission/<%=weeklyReports._id%>" method="post">
												<button type="submit" class="btn btn-success hvr-bounce-in btn-icon animate__animated animate__backInDown">
													
														<i  data-feather="check"></i>
													
												</button>
											</form>
											
											
											
											
											<!-- <button type="button" class="btn my-3 w-100 btn-outline-info" " >Print</button>
											<button type="button" class="btn my-3 w-100 btn-outline-secondary">Sync Report</button>
											<button type="button" class="btn my-3 w-100 btn-outline-primary">Submit</button> -->
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					
				
				
				</div>
				
				

			</div>


				
			
		</div>
		
	</div>

	
<script>
    // Add an event listener to the element with the ID "sendNotes"
    document.getElementById("sendNote").addEventListener("click", function() {
        // Close the modal with the ID "Notes"
        $("#Notes").modal("close");
    });
</script>

<!-- Add  edit updates -->
<div class="modal fade" id="plus" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
	<div class="modal-dialog" role="document">
	  <div class="modal-content">
		<div class="modal-header">
		  <h5 class="modal-title" id="exampleModalLabel">Edit Updates</h5>
		  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
			<span aria-hidden="true">&times;</span>
		  </button>
		</div>
		<div class="modal-body">
		  <form action="/wr/report/update/create" method="post">
			
			<div class="row">
				<div class="col-md-12 grid-margin stretch-card">
						<div class="card-body">
							<textarea class="form-control text-light" rows="10" id="textareab" name="update"></textarea>
						</div>
				</div>
			</div>
  
		<div class=" page-content d-flex justify-content-center align-items-center">
		<div class="modal-footer">
		  <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
		  <button type="submit" class="btn btn-primary"><i data-feather="plus"></i> 
		  Update
		</button>
		</div>
	  </div>
		  </form>
		</div>
	  
	  </div>
	</div>
   </div>

<%- include('includes/end') %>
<script>
	new FroalaEditor('#textareab');
  </script>
   
   <!--   edit updates -->
